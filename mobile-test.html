<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Mobile Test - Mihu AI</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: #0f172a;
            color: #f1f5f9;
            min-height: 100vh;
        }
        
        .container {
            max-width: 600px;
            margin: 0 auto;
        }
        
        .test-section {
            background: #1e293b;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            border: 1px solid #334155;
        }
        
        .test-button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            margin: 10px 5px;
            min-height: 44px;
            min-width: 44px;
        }
        
        .test-button:hover {
            background: #2563eb;
        }
        
        .result {
            background: #0f172a;
            padding: 15px;
            margin: 10px 0;
            border-radius: 6px;
            border: 1px solid #334155;
            font-family: monospace;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        
        .success { border-color: #10b981; }
        .error { border-color: #ef4444; }
        
        input, textarea {
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            border: 1px solid #334155;
            border-radius: 8px;
            background: #282c34;
            color: #f1f5f9;
            font-size: 16px;
            -webkit-appearance: none;
        }
        
        input::placeholder, textarea::placeholder {
            color: #94a3b8;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîß Mobile Test - Mihu AI</h1>
        
        <div class="test-section">
            <h2>üì± Device Info</h2>
            <div id="device-info" class="result"></div>
        </div>
        
        <div class="test-section">
            <h2>üåê Network Test</h2>
            <button class="test-button" onclick="testNetwork()">Test API Connection</button>
            <div id="network-result" class="result"></div>
        </div>
        
        <div class="test-section">
            <h2>ü§ñ AI Test</h2>
            <input type="text" id="test-message" placeholder="Enter test message..." value="Hello from mobile!">
            <button class="test-button" onclick="testAI()">Test AI Response</button>
            <div id="ai-result" class="result"></div>
        </div>
        
        <div class="test-section">
            <h2>üîó Links</h2>
            <button class="test-button" onclick="window.open('http://' + window.location.hostname + ':3002', '_blank')">Open Main App</button>
            <button class="test-button" onclick="window.open('http://' + window.location.hostname + ':3002/auth', '_blank')">Open Auth Page</button>
        </div>
    </div>

    <script>
        // Display device info
        function showDeviceInfo() {
            const info = {
                'User Agent': navigator.userAgent,
                'Platform': navigator.platform,
                'Screen Size': `${screen.width}x${screen.height}`,
                'Viewport Size': `${window.innerWidth}x${window.innerHeight}`,
                'Hostname': window.location.hostname,
                'Protocol': window.location.protocol,
                'Port': window.location.port,
                'Touch Support': 'ontouchstart' in window ? 'Yes' : 'No',
                'Orientation': screen.orientation ? screen.orientation.type : 'Unknown'
            };
            
            document.getElementById('device-info').textContent = 
                Object.entries(info).map(([key, value]) => `${key}: ${value}`).join('\n');
        }
        
        // Test network connection
        async function testNetwork() {
            const resultDiv = document.getElementById('network-result');
            resultDiv.textContent = 'Testing...';
            resultDiv.className = 'result';
            
            try {
                const apiUrl = getApiUrl();
                resultDiv.textContent += `\nAPI URL: ${apiUrl}`;
                
                const response = await fetch(`${apiUrl}/ai`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ 
                        message: "test",
                        sessionId: "mobile_test",
                        userId: 1
                    }),
                });
                
                if (response.ok) {
                    const data = await response.json();
                    resultDiv.textContent += `\n\n‚úÖ SUCCESS!\nStatus: ${response.status}\nResponse: ${JSON.stringify(data, null, 2)}`;
                    resultDiv.className = 'result success';
                } else {
                    resultDiv.textContent += `\n\n‚ùå ERROR!\nStatus: ${response.status}\nStatus Text: ${response.statusText}`;
                    resultDiv.className = 'result error';
                }
            } catch (error) {
                resultDiv.textContent += `\n\n‚ùå NETWORK ERROR!\n${error.message}`;
                resultDiv.className = 'result error';
            }
        }
        
        // Test AI response
        async function testAI() {
            const resultDiv = document.getElementById('ai-result');
            const message = document.getElementById('test-message').value;
            
            resultDiv.textContent = 'Testing AI...';
            resultDiv.className = 'result';
            
            try {
                const apiUrl = getApiUrl();
                const response = await fetch(`${apiUrl}/ai`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ 
                        message: message,
                        sessionId: "mobile_ai_test",
                        userId: 1
                    }),
                });
                
                if (response.ok) {
                    const data = await response.json();
                    resultDiv.textContent = `‚úÖ AI Response:\n\n${data.reply}`;
                    resultDiv.className = 'result success';
                } else {
                    resultDiv.textContent = `‚ùå Error: ${response.status} - ${response.statusText}`;
                    resultDiv.className = 'result error';
                }
            } catch (error) {
                resultDiv.textContent = `‚ùå Network Error: ${error.message}`;
                resultDiv.className = 'result error';
            }
        }
        
        // Get API URL (same logic as main app)
        function getApiUrl() {
            if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
                return 'http://localhost:3002';
            } else if (window.location.hostname.includes('192.168.') || window.location.hostname.includes('10.') || window.location.hostname.includes('172.')) {
                return `http://${window.location.hostname}:3002`;
            } else {
                return window.location.origin;
            }
        }
        
        // Initialize
        showDeviceInfo();
    </script>
</body>
</html>
